!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.Wagon=t.Wagon||{})}(this,function(t){"use strict";function e(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return t.reduceRight(function(t,e){return function(){for(var r=[],o=arguments.length;o--;)r[o]=arguments[o];return e.apply(void 0,[t].concat(r))}})}function r(t){if("object"==typeof t)return function(e,r){void 0===e&&(e={});var o,n={};for(var i in t){var c=t[i],u=e[i],f=void 0;f="function"==typeof c?c(u,r):c,o||u===f||(o=!0),n[i]=f}return o?n:e};throw new Error("The parameter must be an iterable object")}var o=function(t,e){void 0===t&&(t=[]),void 0===e&&(e=[]),this.notify=t,(r=this).middleware.apply(r,e);var r};o.prototype.subscribe=function(t){if("function"!=typeof t)throw new Error("Expected the subscriber to be a function");this.notify.push(t)},o.prototype.unsubscribe=function(t){this.notify.splice(this.notify.indexOf(t)>>>0,1)},o.prototype.middleware=function(){for(var t=this,r=[],o=arguments.length;o--;)r[o]=arguments[o];return this.dispatch=e.apply(void 0,r.concat([function(){for(var e=[],r=arguments.length;r--;)e[r]=arguments[r];t.notify.forEach(function(t){return t.apply(void 0,e)})}]))};var n=function(t){function e(e){var r=this,o=e.reducer,n=e.state,i=e.middleware;void 0===i&&(i=[]),t.call(this),this.getState=function(){return n},(c=this).middleware.apply(c,[].concat(i).map(function(t){if("function"==typeof t)return function(e,o){return t(r,e,o)};throw new Error("Expected the middleware to be a function")}).concat([function(t,e){var o=r.reducer(n,e);return r.compareState(n,o)&&t(n=o),e}])),this.setReducer(o);var c}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setReducer=function(t){if("function"!=typeof t)throw new Error("Expected the reducer to be a function");this.reducer=t,this.dispatch({type:"@AUTORUN"})},e.prototype.compareState=function(t,e){return t!==e},e}(o);t.Store=n,t.Dispatcher=o,t.mapReducer=r,t.createMiddleware=e,Object.defineProperty(t,"__esModule",{value:!0})});